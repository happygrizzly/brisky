{% extends base %}

{% block title %}Documents{% endblock %}
{% block head %}
    {{ parent() }}
    <link href="{{ baseurl }}/assets/styles/grids.css" rel="stylesheet" />
    <link href="{{ baseurl }}/assets/styles/angular-datepicker.css" rel="stylesheet" />
    <link href="{{ baseurl }}/assets/styles/ng-tags-input.css" rel="stylesheet" />
    <link href="{{ baseurl }}/assets/styles/app.documents-catalog.css" rel="stylesheet" type="text/css" />
{% endblock %}

{% block ngApp %} ng-app="documentsCatalogApp" ng-controller="pageController as page" ng-cloak="" {% endblock %}

{% block body %} 

    <div class="page">
        <div class="page-heading clearfix">
            <div class="page-heading-text"><span class="icon icon-flow-tree"></span>Каталог документов</div>
        </div>
        <div class="page-subheading">
            <span ng-hide="page.breadcrumbs.length">Выберите каталог</span>
            <div class="categories-breadcrumbs" ng-show="page.breadcrumbs.length">
                {# refactor: don't request breadcrumbs from database (at least on each directory change) #}
                {# refactor: make .category a div { float: left } #}
                <span ng-repeat="c in page.breadcrumbs" class="category"><span ng-bind="c.name"></span></span>
            </div>
        </div>
        <div class="page-body grid" ng-show="page.currentDirectory.id">
            {# <div ng-view=""></div> #}
            <div class="page-body-section documents-list grid-column column-2-3">
                {% include 'documents/_documents.list.twig' %}
            </div>
            <div class="page-body-section documents-form grid-column column-1-3">
                {% include 'documents/_new.document.form.twig' %}
            </div>
        </div>
    </div>

{% endblock %}

{% block nav %}

    <div ng-controller="navController as nav">
        <div id="nav-departments" class="nav" ng-cloak>
            <ul class="accordion depth-1" ng-repeat="section in nav.toc">
                <li>
                    <input id="label_id-<% section.department.id %>" name="label_id-<% section.department.id %>" type="checkbox" />
                    <label for="label_id-<% section.department.id %>" class="accordion-item label">
                        <span ng-bind="section.department.name"></span>
                    </label>
                    <toctree tree="section.tree" depth="2"></toctree>
                </li>
            </ul>
        </div>
    </div>

{% endblock %}

{% block scripts %} 

    {{ parent() }}

    <script src="{{ baseurl }}/assets/js/lib/ng/angular-locale_ru-ru.js" type="text/javascript"></script>
    <script src="{{ baseurl }}/assets/js/lib/ng/angular-messages.js" type="text/javascript"></script>
    <script src="{{ baseurl }}/assets/js/lib/ng/dirPagination.js" type="text/javascript"></script>
    <script src="{{ baseurl }}/assets/js/lib/ng/ng-tags-input.js" type="text/javascript"></script>
    <script src="{{ baseurl }}/assets/js/lib/ng/angular-datepicker.min.js" type="text/javascript"></script>
    <script src="{{ baseurl }}/assets/js/lib/ng/ng-file-upload-all.min.js" type="text/javascript"></script>
    <script src="{{ baseurl }}/assets/js/app/documents/documentsCatalogApp.js" type="text/javascript"></script>
    <script type="text/javascript">
        angular.module('documentsCatalogApp').constant('API_PREFIX', '{{ API_PREFIX }}');
    </script>

{% endblock %}